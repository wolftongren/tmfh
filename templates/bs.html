<!doctype html>
<html lang="en">
  <head>
	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Dashboard to Stock Monitor</title>
	<!-- Bootstrap core CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	<!-- Custom styles for this template -->
    <link href="{{ url_for('static', filename = 'css/dashboard.css')}}" rel="stylesheet">
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="http://cdn.hcharts.cn/highcharts/4.0.1/highcharts.js"></script>  
     <script type="text/javascript">

        var data2 = {{data}};

        //创建图表
        var chart;

        $(document).ready(function () {

            chart = new Highcharts.Chart({
                chart: {
                    renderTo: 'columnchart',
                    events: {
                        load: st// 定时器
                    }
                },
                title: {
                    text: 'Stock Market Status Monitor'
                },
                xAxis: {
                    categories: ['zhang', 'die', 'ping'],
                    labels: {
                        //rotation: -45,
                        align: 'center'
                    }
                },
                yAxis: {
                    title: {
                        text: 'No. of stocks'
                    }
                },

                plotOptions: {
                    column: {
                        colorByPoint: true,
                        colors: ['red', 'green', 'grey'],
                        dataLabels: {
                            enabled: true,
                            formatter: function () {
                                v = 0;
                                for (i in data2) {
                                    v += data2[i].y;
                                }
                                a = this.y / v * 100;
                                return a.toFixed(2) + "%";
                            }
                        }
                    }
                },

                series: [{
                    name: 'zhangdie distribution',
                    data: data2,
                    type: 'column'
                }]

            });

        });


        //2秒钟刷新一次数据
        function st() {
            setInterval("getData()", 5000);
        }

        //动态更新图表数据
        function getData() {

            $.ajax({
                type: "get",
                url: "/new",
                dataType: "json",
                success: function (datax) {
                    chart.series[0].setData(datax);
                }
            });
        }

    </script>
  </head>

  <body>
	<nav class="navbar navbar-inverse navbar-fixed-top">
	</nav>

	<div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar">
            <li class="active"><a href="#">Overview <span class="sr-only">(current)</span></a></li>
            <li><a href="#">Reports</a></li>
            <li><a href="#">Analytics</a></li>
            <li><a href="#">Export</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">Nav item</a></li>
            <li><a href="">Nav item again</a></li>
            <li><a href="">One more nav</a></li>
            <li><a href="">Another nav item</a></li>
            <li><a href="">More navigation</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <li><a href="">Nav item again</a></li>
            <li><a href="">One more nav</a></li>
            <li><a href="">Another nav item</a></li>
          </ul>
        </div>
		<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h1 class="page-header">Dashboard</h1>
		 <div class="row placeholders">
            <div class="col-xs-6 col-sm-3 placeholder">
              <div id = "columnchart"> </div>
			</div>
            <div class="col-xs-6 col-sm-3 placeholder">
				<h4>Label</h4>
			</div>
            <div class="col-xs-6 col-sm-3 placeholder">
				<h4>Label</h4>
			</div>			
            <div class="col-xs-6 col-sm-3 placeholder">
				<h4>Label</h4>
			</div>
		 </div>	


          <h2 class="sub-header">Section title</h2>
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Header</th>
                  <th>Header</th>
                  <th>Header</th>
                  <th>Header</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1,001</td>
                  <td>Lorem</td>
                  <td>ipsum</td>
                  <td>dolor</td>
                  <td>sit</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                  <td>consectetur</td>
                  <td>adipiscing</td>
                  <td>elit</td>
                </tr>
              </tbody>
            </table>
          </div>
		</div>
      </div>
    </div>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </body>
</html>


